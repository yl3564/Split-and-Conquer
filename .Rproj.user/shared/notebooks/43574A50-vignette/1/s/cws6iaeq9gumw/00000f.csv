"0","# Simulation 3 - Computing time and Misclassification Rate comparison "
"0","# for different number of observations and cores:"
"0","## X is independent"
"0","## Set p = 2n, k = 4"
"0",""
"0","dat2<-data.frame(n=0,ncore=0,""elapsed time""=0,""Missclassiification Rate""=0)"
"0","k=4"
"0","for (n in c(800,1000,1600,2000)) {"
"0","  p<-2*n"
"0","  mu<-matrix(rep(0,p),nrow=p)"
"0","  sigma<-diag(1,nrow=p)"
"0","  X<-mvrnorm(n,mu,sigma)"
"0","  beta<-beta_generate(p,k=30,min=.2,max=.8)"
"0","  y<-y_generate(beta,X)"
"0","  for (ncores in c(2,4)) {"
"0","    t<-0"
"0","    for (z in 1:10) {"
"0","      t1<-proc.time()"
"0","      beta_c<-SC(k,X,y,ncores)"
"0","      pred_y<-1/(1+exp(-X%*%beta_c))"
"0","      pred_y[which(pred_y>0.5)]<-1"
"0","      pred_y[which(pred_y<0.5)]<-0"
"0","      MR2<-(length(y)-sum(pred_y==y))/length(y)"
"0","      t2<-proc.time()"
"0","      t<-t+as.numeric(t2-t1)[3]"
"0","    }"
"0","    t<-t/10"
"0","    dat2<-rbind(dat2,c(n,ncores,t,MR2))"
"0","  }"
"0","  record1<-c(0,0)"
"0","  for (i in 1:10) {"
"0","    record1<-record1+all(X,y)"
"0","  }"
"0","  dat2<-rbind(dat2,c(n,1,record1/10))"
"0","}"
"0","dat2$ncore<-as.character(dat2$ncore)"
"0","dat2<-dat2[-1,]"
"0",""
"0","ggplot(data=dat2,mapping=aes(x=n,y=elapsed.time,colour=ncore))+"
"0","  geom_line()+"
"0","  geom_point(size=1)+"
"0","  scale_x_continuous(breaks=c(800,1000,1600,2000))+"
"0","  scale_color_manual(values=c(""firebrick3"",""gold3"",""green4""))+"
"0","  theme_classic()+"
"0","  labs(subtitle=""p=2n, K=4"")+"
"0","  ylab(""Computing Time"")+"
"0","  xlab(""Number of observations"")"
